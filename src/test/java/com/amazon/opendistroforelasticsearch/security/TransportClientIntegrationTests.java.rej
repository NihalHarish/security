diff a/src/test/java/com/amazon/opendistroforelasticsearch/security/TransportClientIntegrationTests.java b/src/test/java/com/amazon/opendistroforelasticsearch/security/TransportClientIntegrationTests.java	(rejected hunks)
@@ -701,2 +702,16 @@ public class TransportClientIntegrationTests extends SingleClusterTest {
 			
+			ctx = tc.threadPool().getThreadContext().stashContext();
+            searchRes = null;
+            try {
+                tc.threadPool().getThreadContext().putHeader("impersonate_as", "nonexist");
+                searchRes = tc.prepareSearch("starfleet").setTypes("ships").setScroll(TimeValue.timeValueMinutes(5)).get();
+                SearchResponse scrollRes = tc.prepareSearchScroll(searchRes.getScrollId()).get();
+                Assert.assertEquals(0, scrollRes.getFailedShards());
+            } catch (Exception e) {
+                Throwable root = ExceptionUtils.getRootCause(e);
+                Assert.assertTrue(root.getMessage(),root.getMessage().contains("No such transport user: nonexist"));
+            } finally {
+                ctx.close();
+            }
+
 			System.out.println("------- TRC end ---------");
