diff a/src/main/java/com/amazon/opendistroforelasticsearch/security/tools/OpenDistroSecurityAdmin.java b/src/main/java/com/amazon/opendistroforelasticsearch/security/tools/OpenDistroSecurityAdmin.java	(rejected hunks)
@@ -131,5 +132,5 @@ public class OpenDistroSecurityAdmin {
         catch (IndexNotFoundException e) {
-            System.out.println("ERR: No Open Distro Security configuartion index found. Please execute securityadmin with different command line parameters");
+            System.out.println("ERR: No Open Distro Security configuration index found. Please execute securityadmin with different command line parameters");
             System.out.println("When you run it for the first time do not specify -us, -era, -dra or -rl");
-            System.out.println("For more information please look here: http://docs.search-guard.com/v6/troubleshooting-securityadmin");
+            System.out.println("For more information please look here: https://docs.search-guard.com/latest/troubleshooting-securityadmin");
             System.out.println();
@@ -144,3 +145,3 @@ public class OpenDistroSecurityAdmin {
                 System.out.println("ERR: You try to connect with a TLS node certificate instead of an admin client certificate");
-                System.out.println("For more information please look here: http://docs.search-guard.com/v6/troubleshooting-securityadmin");
+                System.out.println("For more information please look here: https://docs.search-guard.com/latest/troubleshooting-securityadmin");
                 System.out.println();
@@ -473,6 +479,6 @@ public class OpenDistroSecurityAdmin {
                 System.out.println("     a configuration error and is therefore forbidden now.");
-                System.out.println("     Pls refer to http://docs.search-guard.com/latest/tls-in-production");
+                System.out.println("     Pls refer to https://docs.search-guard.com/latest/tls-in-production");
                 
                 if(failFast) {
-                    System.exit(-1);
+                    return (-1);
                 }
@@ -498,4 +511,8 @@ public class OpenDistroSecurityAdmin {
                 LicenseInfoResponse res = tc.execute(LicenseInfoAction.INSTANCE, new LicenseInfoRequest()).actionGet();
+                if(res.hasFailures()) {
+                    System.out.println("ERR: Unabe to load license due to "+res.failures());
+                    return -1;
+                }
                 System.out.println(res.toString());
-                System.exit(0);
+                return (0);
             }
@@ -686,3 +706,3 @@ public class OpenDistroSecurityAdmin {
                 System.out.println("Legacy index '"+index+"' detected.");
-                System.out.println("See http://docs.search-guard.com/v6/upgrading-5-6 for more details.");
+                System.out.println("See https://docs.search-guard.com/latest/upgrading-5-6 for more details.");
             }
@@ -774,6 +798,6 @@ public class OpenDistroSecurityAdmin {
 
-        return success;
+        return success && !response.hasFailures();
     }
     
-    private static boolean uploadFile(final Client tc, final String filepath, final String index, final String _id, final boolean legacy) {
+    private static boolean uploadFile(final Client tc, final String filepath, final String index, final String _id, final boolean legacy, boolean resolveEnvVars) {
         
@@ -789,7 +813,7 @@ public class OpenDistroSecurityAdmin {
 
-        try (Reader reader = new FileReader(filepath)) {
-
+        try {
+            final String content = Files.asCharSource(new File(filepath), StandardCharsets.UTF_8).read();
             final String res = tc
                     .index(new IndexRequest(index).type(type).id(id).setRefreshPolicy(RefreshPolicy.IMMEDIATE)
-                            .source(_id, readXContent(reader, XContentType.YAML))).actionGet().getId();
+                            .source(_id, readXContent(resolveEnvVars?OpenDistroSecurityUtils.replaceEnvVars(content, Settings.EMPTY):content, XContentType.YAML))).actionGet().getId();
 
